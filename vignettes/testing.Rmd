---
title: "A Quick Introduction to iNEXT.link via Examples"
author: "CHUNG-E LO"
output: rmarkdown::html_vignette
date: "`r Sys.Date()`"
vignette: >
  %\VignetteIndexEntry{A Quick Introduction to iNEXT.link via Examples}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

## Import 

```{r, include = FALSE, warning=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE, message = FALSE,
  comment = ""
)
#devtools::load_all(".")
library(ggplot2)
#library(kableExtra)
library(knitr)
library(tibble)
library(iNEXT)
library(sets)
library(ade4)
library(tidyverse)
library(ape)
library(dplyr)
library(phytools)
library(magrittr)
Shelfanger <- read.table("F://Chao//Network diversity//shinyapp//heir.entropy//data//Shelfanger.txt")
Hickling <- read.table("F://Chao//Network diversity//shinyapp//heir.entropy//data/Hickling.txt")
Norfolk <- list(Shelfanger = Shelfanger,Hickling = Hickling)
# usethis::use_data(Norfolk, overwrite = T)

Caguana <- read.table("F://Chao//Network diversity//shinyapp//heir.entropy//data/Caguana.txt")
Cialitos <- read.table("F://Chao//Network diversity//shinyapp//heir.entropy//data/Cialitos.txt")
Cordillera <- read.table("F://Chao//Network diversity//shinyapp//heir.entropy//data/Cordillera.txt")
Fronton <- read.table("F://Chao//Network diversity//shinyapp//heir.entropy//data/Fronton.txt")
data <- list(Cordillera = Cordillera,Caguana = Caguana,Fronton = Fronton,Cialitos = Cialitos)


rowtree <- read.newick("F://Chao//Network diversity//shinyapp//heir.entropy//tree/rowtree.txt")
coltree <- read.newick("F://Chao//Network diversity//shinyapp//heir.entropy//tree/coltree.txt")

puerto.rico = list()
puerto.rico[["data"]] = data
puerto.rico[["col.tree"]] = coltree
puerto.rico[["row.tree"]] = rowtree
# usethis::use_data(puerto.rico, overwrite = T)
```

```{r}
library(miNEXT.beta)
source('..//R//iNEXTlink.R')
source('..//R//myfunc.R')
source('..//R//subfunction.R')
```

## Taxonomic: 

### 1.`NetSC()`: 

```{r,eval=T, message = F, warning=F}
sc1 <- SC.link(x = Norfolk, datatype = "abundance", nboot = 10)
```

```{r}
ggSC.link(sc1)
```

### 2.`iNEXT.link()`: 


```{r,eval=T, message = F, warning=F}
sample1 <- iNEXT.link(x = Norfolk, diversity = 'TD', datatype = "abundance", nboot = 10)
```


```{r}
kable(sample1$TDInfo)
```


* `$iNextEst`: Size-based / coverage-based diversity estimates along with confidence intervals and related statistics. 

#### size-based
```{r}
kable(head(sample1$TDiNextEst$size_based,5))
```

#### coverage-based
```{r}
kable(head(sample1$TDiNextEst$coverage_based,5))
```

```{r}
kable(head(sample1$TDAsyEst,9))
```


### 3. ggiNEXT_ND

```{r,echo = TRUE ,fig.width=7, fig.height=4, fig.align="center",warning=FALSE}
ggiNEXT.link(sample1, diversity = 'TD', type = 1,facet.var = "Order.q" )
```


### 4. Empirical / Asymptotic diversity

```{r}
asy1 = Asy.link(Norfolk, diversity = 'TD', q = c(0,1,2),nboot = 10)
head(asy1,5)
```

```{r}
obs1 = Obs.link(Norfolk, diversity = 'TD', q = c(0,1,2),nboot = 10)
head(obs1,5)
```

```{r,echo = TRUE ,fig.width=6, fig.height=4, fig.align="center",warning=FALSE}
ggAsy.link(rbind(obs1, asy1))
```

### 5. `estimateND()`

```{r, eval = T}
kable(estimateD.link(Norfolk, diversity = "TD", datatype="abundance", base="coverage",level=0.7, conf=0.95))
```

### 6. Specialization

```{r, warning=F, message=F}
spec1 = Spec.link(Norfolk, q = seq(0,2,1), datatype = "abundance", nboot =10)
```

```{r,echo = TRUE ,fig.width=7, fig.height=4, fig.align="center",warning=FALSE}
ggSpec.link(spec1)
```


### 7. Dissimilarity

```{r}
dissimilarity1 = iNEXT_beta.link(x = Norfolk, coverage_expected = seq(0.5,1,0.05),
                                 data_type='abundance',
                                 q = c(0, 1, 2),diversity='TD',
                                 nboot = 0, conf = 0.95, max_alpha_coverage=F, by='coverage')
```


```{r,echo = TRUE ,fig.width=7, fig.height=4, fig.align="center",warning=FALSE}
ggiNEXT_beta.link(dissimilarity1, type = 'B')
ggiNEXT_beta.link(dissimilarity1, type = 'D')
```

```{r}
kable(head(dissimilarity1$Region_1$gamma, 10))
kable(head(dissimilarity1$Region_1$alpha, 10))
kable(head(dissimilarity1$Region_1$beta, 10))
```


## Phylogenetic: 

### 1.`NetSC()`: 

```{r,eval=T, message = F, warning=F}
sc1 <- SC.link(x = puerto.rico$data, datatype = "abundance", nboot = 10)
```

```{r}
ggSC.link(sc1)
```

### 2.`iNEXT.link()`: 


```{r,eval=T, message = F, warning=F}
sample2 <- iNEXT.link(x = puerto.rico$data, diversity = 'PD', datatype = "abundance", nboot = 10,
                      col.tree = puerto.rico$col.tree, row.tree = puerto.rico$row.tree)
```


```{r}
kable(sample2$PDInfo)
```

```{r}
kable(head(sample2$PDiNextEst,5))
```

```{r}
kable(head(sample2$PDAsyEst,9))
```


### 3. ggiNEXT_ND

```{r,echo = TRUE ,fig.width=7, fig.height=4, fig.align="center",warning=FALSE}
ggiNEXT.link(sample2, diversity = 'PD', type = 1,facet.var = "Order.q" )
```


### 4. Empirical / Asymptotic diversity

```{r}
asy2 = Asy.link(data = puerto.rico$data, diversity = 'PD', q = c(0,1,2), nboot = 0,
                col.tree = puerto.rico$col.tree, row.tree = puerto.rico$row.tree)
head(asy2,5)
```

```{r}
obs2 = Obs.link(data = puerto.rico$data, diversity = 'PD', q = c(0,1,2),nboot = 10,
                col.tree = puerto.rico$col.tree, row.tree = puerto.rico$row.tree)
head(obs2,5)
```

```{r,echo = TRUE ,fig.width=6, fig.height=4, fig.align="center",warning=FALSE}
ggAsy.link(asy2)
ggAsy.link(obs2)
```

### 5. `estimateND()`

```{r, eval = T}
# kable(estimateD.link(Norfolk, diversity = "TD", datatype="abundance", base="coverage",level=0.7, conf=0.95))
```

### 6. Specialization

```{r, warning=F, message=F}
spec1 = Spec.link(Norfolk, q = seq(0,2,1), datatype = "abundance", nboot =10)
```

```{r,echo = TRUE ,fig.width=7, fig.height=4, fig.align="center",warning=FALSE}
ggSpec.link(spec1)
```


### 7. Dissimilarity

```{r}
dissimilarity2 = iNEXT_beta.link(x = puerto.rico$data, coverage_expected = seq(0.5,1,0.05),
                                 data_type='abundance',
                                 q = c(0, 1, 2),diversity='PD',
                                 nboot = 0, conf = 0.95, max_alpha_coverage=F, by='coverage',
                                 col.tree = puerto.rico$col.tree, row.tree = puerto.rico$row.tree)
```


```{r,echo = TRUE ,fig.width=7, fig.height=4, fig.align="center",warning=FALSE}
ggiNEXT_beta.link(dissimilarity2, diversity = 'PD', type = 'B')
ggiNEXT_beta.link(dissimilarity2, diversity = 'PD',type = 'D')
```

```{r}
kable(head(dissimilarity1$Region_1$gamma, 10))
kable(head(dissimilarity1$Region_1$alpha, 10))
kable(head(dissimilarity1$Region_1$beta, 10))
```
